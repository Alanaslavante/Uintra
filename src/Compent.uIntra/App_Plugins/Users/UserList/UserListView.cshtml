@inherits UmbracoViewPage<Uintra.Users.UserList.UserListViewModel>
@using Uintra.Core.Extensions
@using Newtonsoft.Json

<section class="user-list-panel">
    <div class="block">
        <h3>@Model.Title</h3>
        <input type="text" class="js-user-list-filter" />
    </div>
    <table class="members-table js-user-list-table">
        <thead>
            <tr class="members-table__row">
                @foreach (var column in Model.UsersRows.SelectedColumns)
                {
                    <th class="members-table__head">
                        @if (column.SupportSorting)
                        {
                            var selected = Model.OrderByColumn.Id == column.Id;
                            <a href="" class="js-user-list-sort-link @(selected ? "_asc" : "")"
                               data-order-by="@column.PropertyName">@Html.Localize($"UserList.Table.{column.Alias}.lbl")</a>
                        }
                        else
                        {
                            <span>@Html.Localize($"UserList.Table.{column.Alias}.lbl")</span>
                        }
                    </th>
                }
            </tr>
        </thead>
        <tbody>
            @Html.Partial(Model.UsersRowsViewPath, Model.UsersRows)
        </tbody>
    </table>
    <button class="btn js-user-list-button"
            @if (Model.IsLastRequest) { <text> style="display:none;" </text> }>
        Load more
    </button>
</section>

<script type="text/javascript">
    window.userListConfig = {
        request: {
            skip: 0,
            take: 0,
            query: '',
            orderBy: '@(Model.OrderByColumn?.PropertyName)',
            direction: 0,
            selectedColumns: '@Html.Raw(JsonConvert.SerializeObject(Model.UsersRows.SelectedColumns))'
        },
        amountPerRequest: @Model.AmountPerRequest,
        displayedAmount: @Model.DisplayedAmount
    };
</script>